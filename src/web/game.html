<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameMode Selection</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <h2>GameMode Selection</h2>
        <div class="game-grid">
            <div class="game-mode available mode-1" onclick="selectGame(1)">
                <h3>Chess Moves</h3>
                <p>Human vs Human</p>
                <p>Visualize available moves</p>
            </div>
            <div class="game-mode available mode-2" onclick="showBotConfig()">
                <h3>Chess Bot</h3>
                <p>Human vs AI</p>
                <p>(Stockfish)</p>
            </div>
            <div class="game-mode available mode-3" onclick="selectGame(3)">
                <h3>Sensor Test</h3>
                <p>Test board sensors</p>
            </div>
        </div>

        <!-- Bot Configuration Panel (hidden by default) -->
        <div id="botConfigPanel" class="config-panel anim-panel">
            <h3>Bot Configuration</h3>

            <div style="margin-bottom: 15px;">
                <label style="font-weight: bold;">Your Color:</label><br>
                <select id="botPlayerColor" style="padding: 8px; font-size: 16px; margin-top: 5px; width: 100%;">
                    <option value="white">Play as White (bot is Black)</option>
                    <option value="black">Play as Black (bot is White)</option>
                </select>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="font-weight: bold;">Difficulty:</label><br>
                <select id="botDifficulty" style="padding: 8px; font-size: 16px; margin-top: 5px; width: 100%;">
                    <option value="1">Easy (Depth 5, Fast)</option>
                    <option value="2" selected>Medium (Depth 8, Balanced)</option>
                    <option value="3">Hard (Depth 11, Slow)</option>
                    <option value="4">Expert (Depth 15, Very Slow)</option>
                </select>
            </div>

            <button onclick="selectGame(2)"
                style="padding: 10px 20px; font-size: 16px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; width: 100%;">
                Start Game
            </button>
            <button onclick="hideBotConfig()"
                style="padding: 10px 20px; font-size: 16px; background-color: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer; width: 100%; margin-top: 10px;">
                Cancel
            </button>
        </div>

        <a href="/board" class="button">View Board</a>
        <a href="/" class="back-button">OpenChess Home</a>
    </div>
    <script>
        function showBotConfig() {
            document.getElementById('botConfigPanel').classList.add('visible');
        }

        function hideBotConfig() {
            document.getElementById('botConfigPanel').classList.remove('visible');
        }

        function selectGame(mode) {
            if (mode === 1 || mode === 2 || mode === 3) {
                requestBody = 'gamemode=' + mode;
                if (mode === 2)
                    requestBody += '&playerColor=' + document.getElementById('botPlayerColor').value + '&difficulty=' + document.getElementById('botDifficulty').value;
                fetch('/gameselect', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: requestBody
                }).then(response => response.text()).then(data => {
                    if (mode != 3) // Don't redirect for sensor test
                        window.location.href = "/board";
                }).catch(error => {
                    console.error('Error:', error);
                    alert('Failed to select game mode. Please try again.');
                });
            } else {
                alert('This game mode doesn\'t exist!');
            }
        }
    </script>
</body>

</html>